#' Create simple simulated data from a tibble
#'
#' `stubblise()` (equivalently, `stubblize()`) generates synthetic (i.e.
#' simulated) data to match the structure of a given tibble. See also
#' [col_gen()].
#'
#' @param tbbl the tibble to emulate. Can have 0 rows.
#' @param nrows the number of simulated rows to generate.
#' @param ... additional arguments to control the data format. See
#' [stubblise_control].
#'
#' @details One intened use of `stubblise()` is in generating simple test data
#' for R package development. The function can create very simple synthetic
#' data from most tibbles where columns have standard R vector types. Currently
#' list-columns are not fully supported, and this and any other unsupported
#' types will return a column of NAs.
#'
#' Data are randomly generated by sampling uniformly from a numeric or integer
#' range or from a selection of e.g. characters or factor levels. The
#' parameters controlling this sampling can be modified by the user. At
#' present, the same parameters apply to all columns, and there is no attempt
#' to make the synthetic data look anything like the original data in `tbbl`.
#'
#' The function `stubblize()` is a synonym for `stubblise()` for those who
#' find the "z" more natural or convenient.
#'
#' @return A tibble, with the same structure as `tbbl`, but containing random
#' data. Any columns which are not recognised as being of a standard vector
#' class will have `NA` for all rows and the column type will be `logical`,
#' not the original vector class.
#'
#' @examples
#'
#' \dontrun{
#' library(stubble)
#' }
#' stubblise(iris)
#' stubblise(iris, fct_lvls = levels(iris$Species))
#'
#' @export
stubblise <- function(tbbl, nrows = 10, ...) {

  tryCatch(
    tbbl <- tibble::as_tibble(tbbl),
    error = function(err) stop("Cannot coerce argument 'tbl' to tibble"),
    warning = function(warn) warning(warn)
  )

  tibble::as_tibble(lapply(tbbl, col_gen, nrows = nrows, ...))

}


#' @rdname stubblise
#' @export
stubblize <- stubblise
